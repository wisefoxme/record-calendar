<template>
  <lightning-card title={formattedTitle} icon-name={iconName}>
    <div lwc:if={loading} class="slds-spinner_container">
      <lightning-spinner
        alternative-text={labels.LOADING}
        size="small"
        aria-label={labels.LOADING}
      ></lightning-spinner>
    </div>
    <div
      lwc:else
      class="slds-theme_default slds-datepicker"
      aria-label={labels.DATEPICKER}
      aria-describedby="datepicker-desc"
    >
      <div id="datepicker-desc" class="slds-assistive-text">
        {labels.CHOOSE_A_DATE}
      </div>
      <div class="slds-datepicker__filter slds-grid">
        <div
          class="slds-datepicker__filter_month slds-grid slds-grid_align-spread slds-grow slds-var-m-around_small"
        >
          <div class="slds-align-middle">
            <lightning-button-icon
              title={labels.PREVIOUS_MONTH}
              icon-name="utility:left"
              aria-label={labels.PREVIOUS_MONTH}
              onclick={prevMonth}
              data-id="prevMonthBtn"
            ></lightning-button-icon>
          </div>
          <h2
            aria-atomic="false"
            aria-live="polite"
            class="slds-align-middle"
            data-id="pickerDaySelected-month"
          >
            <div class="slds-text-title_caps">{localeMonthAndYear}</div>
          </h2>
          <div class="slds-align-middle">
            <lightning-button-icon
              title={labels.NEXT_MONTH}
              icon-name="utility:right"
              aria-label={labels.NEXT_MONTH}
              onclick={nextMonth}
              data-id="nextMonthBtn"
            ></lightning-button-icon>
          </div>
        </div>
      </div>
      <table
        class="slds-table slds-table_cell-buffer"
        role="grid"
        aria-labelledby="calendar-heading"
      >
        <tbody>
          <template for:each={weeks} for:item="week">
            <tr key={week.weekNumber}>
              <template for:each={week.days} for:item="day">
                <td
                  key={day.day}
                  aria-selected="false"
                  role="gridcell"
                  class={day.css}
                  aria-label={day.label}
                >
                  <span class="slds-day">{day.label}</span>
                </td>
              </template>
            </tr>
          </template>
        </tbody>
      </table>
    </div>
    <lightning-button-icon
      variant="neutral"
      title={labels.REFRESH}
      onclick={refreshHandler}
      icon-name="utility:refresh"
      slot="actions"
    ></lightning-button-icon>
  </lightning-card>
</template>
